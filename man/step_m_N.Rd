% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/sampler_steps.R
\name{step_m_N}
\alias{step_m_N}
\title{Update step for the scalar parameter m}
\usage{
step_m_N(STV, State, Hyper)
}
\arguments{
\item{STV}{List of starting values and hyperparameters generated by
\code{build_starting_values()}, containing in particular the matrices.
\code{M} and \code{S}, and scalars \code{mum} and \code{sigma2m}.}

\item{State}{List containing the current global state of the sampler.}

\item{Hyper}{List of scalar hyperparameters produced by \code{hyper()}.}
}
\value{
The updated \code{Hyper} list with a new draw for \code{m}.
}
\description{
Updates the global scalar parameter \code{m}.
Conditional on the current values of \code{A}, \code{V},
\code{M}, and the hyperparameters stored in \code{STV} and \code{Hyper},
the function computes the posterior mean and variance of \code{m} and
draws a new value from a univariate normal distribution.
}
\details{
The function computes:
\itemize{
\item the posterior precision contribution from the matrix-normal
likelihood, based on the matrices \code{M}, \code{S}, and \code{V};
\item the posterior variance \code{var_post};
\item the posterior mean \code{mu_post};
\item a new value \code{m_new \~ N(mu_post, var_post)}.
}

Every covariance-related matrix is symmetrized and ridge-stabilized
to ensure numerical positive-definiteness. Cholesky factorizations
are used systematically for robustness.
}
\examples{
# Minimal reproducible structure (dimensions only)
# STV <- build_starting_values(N = 5, K = 10, lag = 2)
# Hyper <- hyper(STV)
# Y_list <- list(matrix(rnorm(50),10,5))
# Z_list <- list(matrix(rnorm(100),10,10))
# State <- init(STV, Y_list, Z_list, Hyper)
# Hyper <- step_m_N(STV, State, Hyper)

}
