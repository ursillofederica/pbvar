% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/sampler_steps.R
\name{step_country_MNIW}
\alias{step_country_MNIW}
\title{MNIW update step for group-specific VAR parameters}
\usage{
step_country_MNIW(Yg, Zg, STV, State, g)
}
\arguments{
\item{Yg}{Matrix. Group-specific dependent variables (\eqn{T_g \times N}).}

\item{Zg}{Matrix. Group-specific regressors (\eqn{T_g \times K}): stacked lag matrices.}

\item{STV}{List of starting values and hyperparameters (from
\code{build_starting_values()}), providing \code{nu}.}

\item{State}{List containing the current global state of the sampler,
including \code{A}, \code{V}, \code{Sigma}, and lists \code{Ag}, \code{Sg}.}

\item{g}{Integer. Index of the group/country to update (position in the \code{Y_list}/\code{Z_list} lists).}
}
\value{
An updated version of \code{State}, where the elements
\code{State$Ag[[g]]} and \code{State$Sg[[g]]} are replaced by their
newly sampled values.
}
\description{
Performs one update for group parameters
in a hierarchical VAR model with Matrix-Normal / Inverse-Wishart
priors. Given the global state (\code{A}, \code{Sigma}, \code{V})
and hyperparameters in \code{STV}, the function updates the
group-specific coefficient matrix \code{A_g} and covariance matrix
\code{S_g}.
}
\details{
The update follows the conditional MNIW structure:
\itemize{
\item \code{S_g} is drawn from an inverse-Wishart.
\item \code{A_g | S_g} is then sampled from a matrix-normal distribution
with mean \code{A_post}, row covariance \code{V_post}, and column
covariance \code{S_g}.
}
All matrices are symmetrized and ridge-stabilized to ensure numerical
positive-definiteness.
}
\examples{
# Dummy example
# Yg <- matrix(rnorm(50), 10, 5)
# Zg <- matrix(rnorm(100), 10, 10)
# STV <- build_starting_values(N = 5, K = 10, lag = 2)
# State <- init(STV, list(Yg), list(Zg), hyper(STV))
# State <- step_country_MNIW(Yg, Zg, STV, State, g = 1)

}
