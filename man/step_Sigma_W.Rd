% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/sampler_steps.R
\name{step_Sigma_W}
\alias{step_Sigma_W}
\title{Global update step for the observation covariance matrix Sigma}
\usage{
step_Sigma_W(STV, State)
}
\arguments{
\item{STV}{List of starting values and hyperparameters generated by
\code{build_starting_values()}, containing in particular \code{SS},
\code{nu}, and \code{mu_Sigma}.}

\item{State}{List containing the current state of the sampler,
including the list \code{Sg} of group-specific covariance matrices,
and the current global value \code{Sigma}.}
}
\value{
The updated \code{State} list with a new draw for \code{Sigma}.
}
\description{
Updates the global observation covariance matrix \code{Sigma}.
Given the group-specific covariance matrices
\code{S_g} and the hyperparameters stored in \code{STV}, the function
constructs the posterior parameters of a Wishart distribution and
samples a new value for \code{Sigma}.
}
\details{
The update computes the inverse-Wishart precision contributions
from the group-specific matrices:
\itemize{
\item Each \code{S_g} contributes its inverse \code{S_g^{-1}}.
\item These are scaled by \code{nu - N - 1} and summed.
\item The global prior contribution is \code{SS^{-1}} from
\code{STV$SS}.
}
All matrices are symmetrized and ridge-stabilized before inversion
to ensure numerical stability.
}
\examples{
# Skeleton example (dimensions only)
# STV <- build_starting_values(N = 5, K = 10, lag = 2)
# Hyper <- hyper(STV)
# Y_list <- list(matrix(rnorm(50),10,5))
# Z_list <- list(matrix(rnorm(100),10,10))
# State <- init(STV, Y_list, Z_list, Hyper)
# State <- step_Sigma_W(STV, State)

}
