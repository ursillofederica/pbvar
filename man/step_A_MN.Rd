% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/sampler_steps.R
\name{step_A_MN}
\alias{step_A_MN}
\title{Global update step for the VAR coefficient matrix A}
\usage{
step_A_MN(STV, State, Hyper)
}
\arguments{
\item{STV}{List of starting values and hyperparameters generated by
\code{build_starting_values()}, providing \code{M} and \code{S}.}

\item{State}{List containing the current global state of the sampler
(including \code{A}, \code{V}, and the lists \code{Ag}, \code{Sg}).}

\item{Hyper}{List of scalar hyperparameters generated by \code{hyper()},
containing in particular \code{m} and \code{s}.}
}
\value{
The \code{State} list updated with a new draw for \code{A}.
}
\description{
Performs the global update of the coefficient matrix \code{A}.
Conditional on the group-specific matrices
\code{A_g} and \code{S_g}, and on the covariance matrix \code{V},
the function computes the posterior parameters of the matrix-normal
distribution for \code{A} and draws a new sample accordingly.
}
\details{
The update corresponds to the conditional posterior
\deqn{A \mid \{A_g, S_g\}, V \sim MN(M_{A,\post},\, V,\, S_{A,\post}^{-1})}
derived from a matrix-normal prior and the group-specific deviations.
The function computes:
\itemize{
\item the precision matrix \code{SA_post},
\item the posterior mean \code{MA_post},
\item and finally samples \code{A} using \code{rmatnorm()}.
}
All matrices are symmetrized and ridge-stabilized before inversion
to ensure numerical consistency.
}
\examples{
# Minimal reproducible structure (dimensions only)
# STV <- build_starting_values(N = 5, K = 10, lag = 2)
# Hyper <- hyper(STV)
# State <- init(STV, list(matrix(rnorm(50),10,5)),
#                     list(matrix(rnorm(100),10,10)), Hyper)
# State <- step_A_MN(STV, State, Hyper)

}
