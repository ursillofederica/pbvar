% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/starting_values.R
\name{init}
\alias{init}
\title{Build initial state matrices for the sampler}
\usage{
init(STV, Y_list, Z_list, Hyper)
}
\arguments{
\item{STV}{List of starting values produced by
\code{build_starting_values()}, containing \code{M}, \code{W},
\code{SS}, \code{mu_Sigma}, \code{eta}, \code{nu}, and related
hyperparameters.}

\item{Y_list}{List of data matrices \code{Y_i}, each of size
\eqn{T_i \times N}, one for each group.}

\item{Z_list}{List of regressor matrices \code{Z_i}, each of size
\eqn{T_i \times K}, one for each group, typically the stacked-lag
companion regressors.}

\item{Hyper}{List of scalar hyperparameters sampled by \code{hyper()},
including \code{m}, \code{s}, \code{w}, and \code{s_Sigma}.}
}
\value{
A list containing:
\itemize{
\item \code{A} – K × N pooled initial coefficient matrix.
\item \code{Sigma} – N × N pooled residual covariance matrix
(MAP inverse-Wishart estimate).
\item \code{V} – K × K state covariance matrix (MAP inverse-Wishart estimate).
\item \code{Ag} – list of group-specific OLS coefficient matrices (K × N).
\item \code{Sg} – list of group-specific covariance matrices (N × N).
}
}
\description{
Computes starting values for the state of the sampler in a panel-VAR
or multi-group VAR setting. For each group, the function estimates
initial coefficient matrices using OLS and computes corresponding
residual covariance matrices. It then combines the group-specific
quantities to produce initial values for \code{A}. \code{Sigma_g}, \code{Sigma},
and \code{V} based on MAP estimates under Wishart and inverse-Wishart priors.
}
\details{
For the covariance matrices, the function uses MAP estimates under
inverse-Wishart/Wishart priors instead of direct prior draws. This
provides numerically stable and reasonably central starting values
for the sampler, which is particularly useful in high-dimensional
settings with many parameters.

\enumerate{
\item Group-wise OLS estimation of VAR coefficients using a QR decomposition.
\item Computation of group residual covariance matrices \code{RSS_i}.
\item Pooled MAP estimates for \code{Sigma} and \code{V} under inverse-Wishart priors.
\item Group-specific MAP estimates \code{Sg} for residual covariances.
}
}
\examples{
# Example with dummy data (small dimensions)
Y_list <- list(matrix(rnorm(50), 10, 5))
Z_list <- list(matrix(rnorm(100), 10, 10))
STV <- build_starting_values(N = 5, K = 10, lag = 2)
Hyper <- hyper(STV)
out <- init(STV, Y_list, Z_list, Hyper)
str(out)

}
