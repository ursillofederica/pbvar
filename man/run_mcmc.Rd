% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/sampler_wrapper.R
\name{run_mcmc}
\alias{run_mcmc}
\title{Run the hierarchical VAR MCMC sampler}
\usage{
run_mcmc(
  Y_list,
  Z_list,
  lag,
  fixed_list,
  R,
  burnin,
  thin,
  nChains,
  var_names = NULL,
  lag_names = NULL,
  country_names = NULL
)
}
\arguments{
\item{Y_list}{List of matrices \code{Y_g}, each of size \eqn{T_g \times N},
representing the dependent variables for each group.}

\item{Z_list}{List of matrices \code{Z_g}, each of size \eqn{T_g \times K},
containing the stacked-lag regressors of the VAR.}

\item{lag}{Integer. Maximum autoregressive lag of the VAR.}

\item{fixed_list}{Optional list of fixed hyperparameters passed to
\code{build_starting_values()}.}

\item{R}{Integer. Number of post-burnin MCMC iterations (before thinning).}

\item{burnin}{Integer. Number of initial iterations discarded.}

\item{thin}{Integer. Thinning interval.}

\item{nChains}{Integer. Number of independent MCMC chains.}

\item{var_names}{Character vector of length \eqn{N} with the names of the endogenous variables.}

\item{lag_names}{Character vector with labels for lagged regressors (used in summaries/plots).}

\item{country_names}{Character vector of length \code{length(Y_list)} with group/country names.}
}
\value{
A list with one element per chain, each containing:
\itemize{
\item \code{samples} — lists of stored draws for \code{A}, \code{V},
\code{Sigma}, \code{Ag}, \code{Sg}, and scalar hyperparameters;
\item \code{last_state} — the final value of the state matrices;
\item \code{last_hyper} — the final values of scalar hyperparameters.
}
}
\description{
Runs the full MCMC algorithm for the hierarchical VAR model.
For each chain, the function:
\enumerate{
\item builds starting values and initializes hyperparameters;
\item performs the group-specific MNIW updates;
\item updates global parameters \code{A}, \code{V}, and \code{Sigma};
\item updates all scalar hyperparameters;
\item stores thinned post-burnin draws.
}
Multiple chains can be run independently, each with its own seed.
}
\details{
The function internally uses:
\itemize{
\item \code{build_starting_values()} for initial states,
\item \code{hyper()} for first hyperparameter draws,
\item \code{step_country_MNIW()} for group-level updates,
\item \code{step_A_MN()}, \code{step_V_IW()}, \code{step_Sigma_W()}
for global parameters,
\item \code{step_hyper_all()} for all scalar hyperparameters.
}
}
\examples{
# Simulate minimal data
Y_list <- list(matrix(rnorm(50), 10, 5))
Z_list <- list(matrix(rnorm(50), 10, 5))

# Variable names (optional)
vnames <- paste0("V", 1:5)
lnames <- paste0("L", 1:5)
cnames <- paste0("C", seq_along(Y_list))


out <- run_mcmc(
  Y_list, Z_list,
  lag = 1,
  fixed_list = NULL,
  R = 100,
  burnin = 50,
  thin = 2,
  nChains = 1,
  var_names = vnames,
  lag_names = lnames,
  country_names = cnames
)

# Inspect results
str(out)

}
